version: "3"

services:
  promtail:
    image: grafana/promtail:latest
    container_name: promtail-unraid
    restart: unless-stopped
    volumes:
      # Docker socket to read container logs
      - /var/run/docker.sock:/var/run/docker.sock:ro
      # System logs
      - /var/log:/var/log:ro
      # Promtail config
      - /mnt/user/appdata/promtail/config.yml:/etc/promtail/config.yml:ro
      # Promtail positions file (tracks what's been read)
      - /mnt/user/appdata/promtail/positions.yaml:/tmp/positions.yaml
    command: -config.file=/etc/promtail/config.yml
    network_mode: bridge
    ports:
      - "9080:9080"
